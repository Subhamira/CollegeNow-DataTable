 <!DOCTYPE>
<html>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/pdfmake-0.1.27/dt-1.10.15/b-1.4.0/b-colvis-1.4.0/b-flash-1.4.0/b-html5-1.4.0/b-print-1.4.0/r-2.1.1/datatables.min.css"/>
  <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.3.0/build/cssreset/reset-min.css"/>
	<link rel="stylesheet" type="text/css" href="objectsaddedfeatures.css"/>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css"/>
	<!--<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap.min.css"/>-->
	<link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/scroller/1.4.2/css/scroller.bootstrap.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.1.1/css/responsive.bootstrap.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/scroller/1.4.2/css/scroller.bootstrap.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">	
	<link rel="html" type="html" href="//cdn.datatables.net/plug-ins/1.10.16/features/pageResize/scrolling.html"/>
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.js"></script>
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>	
	<script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.1.1/js/dataTables.responsive.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/responsive/2.1.1/js/responsive.bootstrap.min.js"></script>
	<script type="text/javascript" src="//cdn.datatables.net/plug-ins/1.10.16/features/pageResize/dataTables.pageResize.js"></script>	
	<script type="text/javascript" src="https://cdn.datatables.net/scroller/1.4.2/js/dataTables.scroller.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.11.3/xlsx.full.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.4/jszip.js"></script>
  <!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.js"></script>-->
  <script type="text/javascript" src="https://cdn.datatables.net/v/dt/pdfmake-0.1.27/dt-1.10.15/b-1.4.0/b-colvis-1.4.0/b-flash-1.4.0/b-html5-1.4.0/b-print-1.4.0/r-2.1.1/datatables.min.js"></script>
	
	<!--toggle between table and card view---------------------------------------------------------------------->
	<body>
<div class="student_status">
<p>Please select your highest completed education</p>

<div class="select-style">
  
<select id="Student">

    <option style="color:white">Student Status</option>
 
   <option style="color:black" value="High School Students">High School Students</option>

    <option style="color:black" value="Undergrad">Undergrad</option>

    <option style="color:black" value="College Graduate">College Graduate</option>

    <option style="color:black" value="Adult Learner">Adult Learner</option>

    <option style="color:black" value="PHD">PHD</option>

    <option style="color:black" value="Undocumented">Undocumented</option>

   </select>
 
 </div> 
</div>
	<div class="container" style="display: none;">
		            <div class="col-sm-12">
                <button id="btToggleDisplay" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-th-list" align="center"></span>Toggle</button>
            </div>


<!--social media buttons--------------------------------------------------------------------------------------->
<a href="https://www.facebook.com/share" class="fa fa-facebook" align="right"></a>
<a href="https://www.twitter.com/share" class="fa fa-twitter"   align="right"></a>
<a href="https:///www.linkedin.com/share" class="fa fa-linkedin" align="right"></a>
<a href="https://www.instagram.com/share" class="fa fa-instagram" align="right"></a>	

	<!---Modal-------------------------------------------------------------------------------------------------->	
		<div class="modal fade" id="myModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Details</h4>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div> <!--/.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

	<!--table headers---------------------------------------------------------------------------------------->	
		
    <table id="data-table" class="table table-striped table-hover table-bordered compact dataTable dt-responsive no wrap" cellspacing="0" width="100%" data-show-toggle="true">
      <thead>
        <tr data-toggle="modal" data-id="1" data-target="#orderModal">
          <th>DropbdownSelection</th>
          <th>Text in the result listing</th>
          <th>Text in the result listing_1</th>
          <th>Input box number only</th>
          <th>Input box number only_1</th>
          <th>Dropdown</th>
          <th>Multi-Select</th>
          <th>Input Box</th>
          <th>Input Box_1</th>
          <th>Text in the result listing_2</th>
          <th>Text in the result listing (Hyperlink) open in NEW WINDOW</th>
        </tr>
      </thead>
	<!---selected dropdown table footer---------------------------------------------------------------------->
     <tfoot>        
        <tr>
          <th>DropbdownSelection</th>
       
        	<th>         </th>
					<th>         </th>
          <th>Input box number only</th>
          <th>Input box number only_1</th>
          <th>Dropdown</th>
          <th>Multi-Select</th>
          <th>      </th>
          <th>      </th>
          <th>Text in the result listing_2</th>
         <th>        </th>
        </tr>
      </tfoot>
    </table>


</div>

<!--get json data from .xlsx sheet.js---------------------------------------------------------------------------->
<script>
    //create JSON 
    var url = "./Scholarship_Database.xlsx"; 
    var oReq = new XMLHttpRequest(); 
    var result = '' 
    var DATA = [] 
    var arr = [] 
	var sortedData = []
    var input1 = ''
    
    oReq.open("GET", url, true); 
    oReq.responseType = "arraybuffer"; 
    
    oReq.onload = function(e){ 
    var arraybuffer = oReq.response; 
    // convert data to binary string 
    var data = new Uint8Array(arraybuffer) 
    var arr = [] 
    for (var i = 0; i != data.length; ++i)
    arr[i] = String.fromCharCode(data[i]) 
    var bstr = arr.join("") 
    // Call XLSX 
    var workbook = XLSX.read(bstr, { type: "binary" }) 
    // DO SOMETHING WITH workbook HERE
    var first_sheet_name = workbook.SheetNames[0] 
    // Get worksheet 
    var worksheet = workbook.Sheets[first_sheet_name]; 
    result = XLSX.utils.sheet_to_json(worksheet);
	console.log(result)
	}    
	
	oReq.send()

	function sort(arr){
		for(var i = 0; i < arr.length; i++){
			if(arr[i].DropbdownSelection === input1){
				sortedData.push(arr[i])
				}
			}
	}	

	

	$(document).ready(function(){
	$("#Student").change(function(){
	$('.student_status').fadeOut(1000);
	$('.container').fadeIn(1000);	
	input1 = $("#Student option:selected").text()
  			getStudentData()
		})
	})		
	
	var sorted_results = ''
	
	function getStudentData(){
		sort(result)
		sorted_results = sortedData
		createTable()
	}

	function createTable(){
      $(document).ready(function() { 
        console.log(result) 
			

		//set undefined or empty data as not set----------------------------------------------------------------------

        var dataSet = sorted_results //result, 
            columnDefs = [{
                           "data": "DropbdownSelection", "defaultContent": "<i>Not set</i>"}, 
                          { "data": "Text in the result listing", "defaultContent": "<i>Not set</i>" }, 
                          { "data": "Text in the result listing_1", "defaultContent": "<i>Not set</i>"}, 
                          { "data": "Input box number only", "defaultContent": "<i>Not set</i>" }, 
                          { "data": "Input box number only_1", "defaultContent": "<i>Not set</i>" }, 
                          { "data": "Dropdown", "defaultContent": "<i>Not set</i>" }, 
                          { "data": "Multi-Select", "defaultContent": "<i>Not set</i>" }, 
                          { "data": "Input Box", "defaultContent": "<i>Not set</i>"}, 
                          { "data": "Input Box_1", "defaultContent": "<i>Not set</i>" }, 
                          { "data": "Text in the result listing_2", "defaultContent": "<i>Not set</i>" }, 
                          { "data": "Text in the result listing (Hyperlink) open in NEW WINDOW", "defaultContent": "<i>Not set</i>", 
                          "render": function(data, type, row, meta){
                              if(type === 'display'){
                              dataSet = '<a href="' + data + '">' + data + '</a>';
	                        }
                              return dataSet;},                         
                          }];
  //modal-----------------------------------------------------------------------------------------------       
           var myTable;
            myTable = $("#data-table").DataTable({
                          responsive: {
																					details: {
																							display: $.fn.dataTable.Responsive.display.modal( {
																									header: function ( row ) {
																											var data = row.data();
																											return 'Details';
																									}
																							} ),
																							renderer: $.fn.dataTable.Responsive.renderer.tableAll( {
																									tableClass: 'table'
																							} )
																					}
																			},
                          //dom: "Blfrtip"
														dom: '<"top"B><"top"l><"Search"f>rt<"bottom"ip><"clear">',
                         // buttons: ['copy', 'excel', 'pdf', 'print'],
													buttons: [ 'pdf', 'print' ],
                          "lengthMenu": [ [10, 25, 50, -1], [10, 25, 50, "All"] ],
                          "sPaginationType": "full_numbers",		//
                          "bFilter" : true,
                          "bSort" : true,
//change header name-----------------------------------------------------------------------------------------
                          data: dataSet, columns: columnDefs,
                          'initComplete': function(settings) 
                          { var api = new $.fn.dataTable.Api(settings); api.columns().header().each(function(column) 
                          { if ($(column).text() === 'DropbdownSelection')
                          { $(column).text("Student Status"); } 
                          else if ($(column).text() === 'Text in the result listing') 
                          { $(column).text("Scholorship/Award Name"); } 
                          else if ($(column).text()=== 'Text in the result listing_1') 
                          { $(column).text("Criteria"); } 
                          else if ($(column).text() === 'Input box number only') 
                          { $(column).text("GPA Required"); } 
                          else if ($(column).text() === 'Input box number only_1') 
                          { $(column).text("ACT"); } 
                          else if ($(column).text() === 'Multi-Select') 
                          { $(column).text("Ethnic-Heritage");} 
                          else if ($(column).text() === 'Dropdown') 
                          { $(column).text("Gender"); } 
                          else if ($(column).text() === 'Input Box') 
                          { $(column).text("Open Date"); } 
                          else if ($(column).text() === 'Input Box_1') 
                          { $(column).text("Closing Date"); } 
                          else if ($(column).text() === 'Text in the result listing_2') 
                          { $(column).text("Possible Award");} 
                          else if ($(column).text() === 'Text in the result listing (Hyperlink) open in NEW WINDOW')
                          { $(column).text("Website"); } 
                          });                                                       
                          },
							
												});
        							
												
	//function for selected dropdown---------------------------------------------------------------------------------									
                    myTable.columns([/*0,*/3,4,5,6,9]).every( function () {
                      var column = this;
												var select = $('<select id="drop"><option value="" >Show All</option></select>')
														.appendTo( $(column.header()).empty() )
														.on( 'change', function () {
																var val = $.fn.dataTable.util.escapeRegex(
																		$(this).val()
																);

																column
																		.search( val ? '^'+val+'$' : '', true, false )
																		.draw();
														} );

												column.data().unique().sort().each( function ( d, j ) {
														select.append( '<option value="'+d+'">'+d+'</option>' )
												} );
										} );

//function for toggle between table view and card view------------------------------------------------------------- 									
										$('#btToggleDisplay').on('click', function () {
                		$("#data-table").toggleClass('cards')
                		$("#data-table thead").toggle()
            				});

	

				
//oreq.onload ends-----------------------------------------------------------------------------------------------
				
				
          }) 
    } 
    
    //oReq.send(result);
    
    </script>
		
<!--send email to college now------------------------------------------------------------------------------> 
<div id="email">
			
		<form action="mailto:subha_mira@yahoo.com" method="post" enctype="text/plain" align="center">
			Your Name:<br>
			<input type="text" name="name"><br>
			Your E-mail:<br>
			<input type="text" name="mail"><br>
			Leave a Comment:<br>
			<input type="text" name="comment" size="40" ><br><br>
			<input type="submit" value="E-mail">
			<input type="reset" value="Reset">
		</form>
</div>		
		
		
  </body>
</html>
